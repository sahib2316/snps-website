<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign-up Page</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />

    <link rel="stylesheet" href="./css/style.css" />
  </head>
  <body>
    <!-- <div class="modal-dialog modal-xl">...</div>
    <div class="modal-dialog modal-lg">...</div>
    <div class="modal-dialog modal-sm">...</div> -->

<nav aria-label="breadcrumb">
  <ol class="breadcrumb bg-transparent">
    <li class="breadcrumb-item"><a href="./" class="text-light">Home</a></li>
    <li class="breadcrumb-item active" aria-current="page">Sign-up</li>
  </ol>
</nav>
    <div class="container-fluid">
      <div class="container text-center my-3">
        <img src="/assets/images/new.png" width="350px" height="180px" alt="" />
      </div>

      <div class="container text-start">
        <div class="row">
          <div class="col-md-4"></div>
          <div class="col-md-4 border border-warning p-5">
            <div class="needs-validation" novalidate>
              <div class="form-row">
                <div class="col-md-12 mb-3">
                  <label for="validationCustom01" class="text-light">Name</label>
                  <input
                    type="text"
                    class="form-control"
                    id="validationCustom01"
                    placeholder="Full Name"
                    required
                  />
                  <div class="valid-feedback">Looks good!</div>
                </div>
                <div class="col-md-9 mb-3">
                  <label for="validationCustom02" class="text-light">Mobile No.</label>
                  <input
                    type="number"
                    class="form-control"
                    id="validationCustom02"
                    placeholder="Your Number"
                    value="Otto"
                    required
                  />
                  <div class="valid-feedback">Looks good!</div>
                </div>
                <div class="form-row">
                <div class="col-md-12 mb-2">
                  <label for="validationCustom" class="text-light">Email/Mobile No.</label>
                  <input
                    type="text"
                    class="form-control bg-secondary"
                    id="validationCustom"
                    placeholder="Email"
                    required
                  />
                  <div class="invalid-feedback">
                    Please provide a valid email address.
                  </div>
                </div>
              <div class="form-row">
                <div class="col-md-12 mb-3">
                  <label for="validationCustom03" class="text-light">Password</label>
                  <input
                    type="password"
                    class="form-control"
                    id="validationCustom03"
                    placeholder="Password"
                    required
                  />
                  <div class="invalid-feedback">
                    Please keep a strong password.
                  </div>
                </div>
                <div class="col-md-12 mb-3">
                  <label for="validationCustom04" class="text-light">Address</label>
                  <input
                    type="text"
                    class="form-control"
                    id="validationCustom04"
                    placeholder="City/Town,State"
                    required
                  />
                  <div class="invalid-feedback">
                    Please provide a valid Address.
                  </div>
                </div>
                <div class="col-md-12 mb-3">
                  <label for="validationCustom05" class="text-light">City</label>
                  <input
                    type="text"
                    class="form-control"
                    id="validationCustom05"
                    placeholder="Town/Area"
                    required
                  />
                  <div class="invalid-feedback">
                    Please provide a valid City Name.
                  </div>
                </div>
                <div class="col-md-12 mb-3">
                  <label for="validationCustom06" class="text-light">PinCode</label>
                  <input
                    type="number"
                    class="form-control"
                    id="validationCustom06"
                    placeholder="Zip"
                    required
                  />
                  <div class="invalid-feedback">
                    Please provide a valid Pin.
                  </div>
                </div>
              </div>
              <div class="form-group">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    value=""
                    id="invalidCheck"
                    required
                  />
                  <label class="form-check-label" for="invalidCheck">
                    Agree to terms and conditions
                  </label>
                  <div class="invalid-feedback">
                    You must agree before submitting.
                  </div>
                </div>
              </div>

              <!-- signup and login -->
              <div>
                <div>
              <input class="btn btn-outline-light" type="submit" name="signup_submit" id="signUp" value="Sign Up">
            </div>

              <div class="pt-3 text-light">
              <h6>Already Signed-in? <a href="" class="text-warning" id="goTo">Login</a> here.</h6>
            </div>
          </div>
              <!-- signup and login end -->

            </div>

            <script>
        goTo.addEventListener("click", (e) => {
          document.getElementById("goTo").href = "/login.html";
        });
              // Example starter JavaScript for disabling form submissions if there are invalid fields
              (function () {
                "use strict";
                window.addEventListener(
                  "load",
                  function () {
                    // Fetch all the forms we want to apply custom Bootstrap validation styles to
                    var forms =
                      document.getElementsByClassName("needs-validation");
                    // Loop over them and prevent submission
                    var validation = Array.prototype.filter.call(
                      forms,
                      function (form) {
                        form.addEventListener(
                          "submit",
                          function (event) {
                            if (form.checkValidity() === false) {
                              event.preventDefault();
                              event.stopPropagation();
                            }
                            form.classList.add("was-validated");
                          },
                          false
                        );
                      }
                    );
                  },
                  false
                );
              })();
            </script>
          </div>
          <div class="col-md-4"></div>
        </div>
      </div>
      
<!-- Footer Container -->
      <div class="container">
        <footer class="page-footer font-small blue pt-4">
          <!-- <div class="row">
            <div class="col-sm-12">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title">Our Website</h5>
                  <p class="card-text text-light">
                    Visit our website and explore the vastness of our services.
                    We can provide our expertise on a wide spectrum and really
                    guide to yourd journey.
                  </p>
                  <a href="#" class="btn btn-outline-light">Go somewhere</a>
                </div>
              </div>
            </div>
          </div> -->

          <!-- Copyright -->
          <div class="footer-copyright text-center text-light">
            @Copyright
            <a href="/" class="text-light"> SNPS pvt Ltd</a>
          </div>
          <!-- Copyright -->
        </footer>
        <!-- Footer -->
      </div>
<!--End Footer Container -->

    </div>

    <!-- <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js"></script> -->
  <!-- Imports and configuration section -->
 <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-firestore.js"></script>
  <script src= "https://www.gstatic.com/firebasejs/8.0.2/firebase-auth.js"></script>

 <script>
  if (localStorage.getItem("isLoggedIn") === "true") {
        window.location.assign("/");
      }
    // Your web app's Firebase configuration
    const firebaseConfig = {
    apiKey: "AIzaSyBcvOMCgE-24Y8k5KAzwjrblAsRyqJb-eI",
    authDomain: "projectdb-402ec.firebaseapp.com",
    databaseURL: "https://projectdb-402ec-default-rtdb.firebaseio.com",
    projectId: "projectdb-402ec",
    storageBucket: "projectdb-402ec.appspot.com",
    messagingSenderId: "818279951216",
    appId: "1:818279951216:web:f0ef3bd656247176f0fdb5"
  };
    // Initialize Firebase
      firebase.initializeApp(firebaseConfig);

    // Instantialize variables
    // const database = getDatabase(app);
    // Initialize Firebase Authentication and get a reference to the service
    // const auth = getAuth(app);
    // const db = firebase.firestore();
const signUp=document.getElementById("signUp");

    // Move on the Auth
signUp.addEventListener("click", (e) => {
e.preventDefault(); // prevent default behavior of form submission

  // Get all the input fields
  var full_name = document.getElementById("validationCustom01").value;
  var mobile = document.getElementById("validationCustom02").value;
  var emailOrMobile = document.getElementById("validationCustom").value;
  var password = document.getElementById("validationCustom03").value;
  var address = document.getElementById("validationCustom04").value;
  var city = document.getElementById("validationCustom05").value;
  var pinCode = document.getElementById("validationCustom06").value;
  var agreeCheck = document.getElementById("invalidCheck").value;

  // Check for empty fields
  if (full_name === "" || mobile === "" || emailOrMobile === "" || password === "" || address === "" || city === "" || pinCode === "" ) {
    alert("Please fill in all the fields");
    
    // Return false to prevent submission
    return false;
  }

// if (!agreeCheck.checked) {
//   alert("You have to check to our terms to sign-up!");

//   return false;
// }

// Determine whether the input is an email or mobile number
var isEmail = false;
var isMobile = false;

// Check if the input matches an email format
if (emailOrMobile.includes('@')) {
  isEmail = true;
}

// Check if the input matches a mobile number format (e.g., 10 digits)
if (/^\d{10}$/.test(emailOrMobile)) {
  isMobile = true;
}


if (isEmail) {
 firebase.auth().createUserWithEmailAndPassword(emailOrMobile, password)
    .then((userCredential) => {
      // Signed in
      const user = userCredential.user;
      var userData = {
        Name: full_name,
        Email: emailOrMobile,
        Mobile: mobile,
        Address: address,
        City: city,
        PinCode: pinCode,
        role:""
      };
      
      const db = firebase.firestore();

      // Add data to Firestore
      db.collection("userDetails").doc(user.uid).set(userData).then(function () {
        window.location.assign("/login.html");
      })
      .catch(function (error) {
        console.error("Error adding document: ", error);
      });

      alert("You have signed Up successfully"); 
    })
    .catch((error) => {
      const errorCode = error.code;
      const errorMessage = error.message;
      alert(errorMessage);
    });

} else if (isMobile) {
  // Handle mobile number sign up
// You can choose to generate a unique email address for the user or use the mobile number itself as the email
var generatedEmail = emailOrMobile + "@example.com"; // Replace with your desired domain
firebase.auth().createUserWithEmailAndPassword(generatedEmail, password)
  .then((userCredential) => {
    // Signed in
    const user = userCredential.user;
    var userData = {
      Name: full_name,
      Email: emailOrMobile, // Use the mobile number or generated email as the identifier
      Mobile: emailOrMobile, // Use the mobile number as the value
      Address: address,
      City: city,
      PinCode: pinCode,
      role: ""
    };

    const db = firebase.firestore();

    // Add data to Firestore
    db.collection("userDetails").doc(user.uid).set(userData).then(function () {
      window.location.assign("/login.html");
    })
    .catch(function (error) {
      console.error("Error adding document: ", error);
    });

    alert("You have signed up successfully"); 
  })
  .catch((error) => {
    // Handle error
    console.error("Error creating user: ", error);
  });
}

});

  </script>
  <!-- <script src="./js/index.js"></script> -->
  <script
    src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js"
    integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"
    integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"
  ></script>
  </body>

</html>
